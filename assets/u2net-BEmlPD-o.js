import{O as h,i as x,u as g,a as I}from"./opencv-helpers-Fku369FT.js";import{s as S,_ as k,r,o as c,c as f,a as s,b as w,d as _,w as N,e as y,f as p,t as V}from"./index-BpQvI-0Z.js";import{S as P,U as W,P as B,M as O}from"./samples-BXu_c90V.js";import"./onnxruntime-web-CTuRU3N_.js";const C={components:{Samples:P,UploadView:W,ProgressView:B,MyImage:O},data(){return{loading:!1,countdown:"",interval:void 0,showNoWebGpuWarning:!1}},unmounted(){h.Instance.removeAllSessions()},mounted(){Promise.resolve().then(async()=>{await S()||(this.showNoWebGpuWarning=!0)}),crossOriginIsolated||console.log("crossOriginIsolated off")},methods:{async useSample(m){try{const e=await(await fetch(m)).blob();await this.onInputFile(e)}catch(e){alert(String(e?.message||e))}},async onInputFile(m){if(this.loading)return;const e=Date.now();this.interval=setInterval(()=>{const t=Date.now()-e,l=Math.floor(t/1e3),o=t%1e3;this.countdown=`${l}.${o}`}),this.loading=!0;try{const t=await x(m),l=this.$refs.task,o=Array.from(l.childNodes).map(i=>i.textContent),u=l.value,n=o.findIndex(i=>i==u);if(n<0)return;let a;n==0?a=await g(t,"general"):n==1?a=await g(t,"human"):n==2&&(a=await I(t)),await this.$refs.output.setImage(t,a)}catch(t){console.error(t),alert(String(t?.message||t))}finally{clearInterval(this.interval),this.loading=!1}}}},F={style:{"text-align":"center"}},G={class:"col-11 md:col-3 p-dropdown border-round-2xl p-3 text-lg",style:{"margin-inline":"auto"},ref:"task"},U={key:1};function M(m,e,t,l,o,u){const n=r("message"),a=r("upload-view"),i=r("ProgressView"),v=r("my-image"),b=r("samples");return c(),f("div",F,[e[4]||(e[4]=s("div",{class:"py-2"},null,-1)),e[5]||(e[5]=s("h4",{class:"text-xl"},[w("Remove Background - "),s("a",{target:"_blank",href:"https://github.com/xuebinqin/U-2-Net/"},"U2Net")],-1)),o.showNoWebGpuWarning?(c(),_(n,{key:0,closable:!1,class:"col-11 md:col-4",style:{"margin-inline":"auto"},severity:"warn"},{default:N(()=>e[2]||(e[2]=[w("WebGpu Support not found, inference will be slow")])),_:1})):y("",!0),p(a,{class:"col-11 md:col-7",style:{"margin-inline":"auto"},onOnFile:e[0]||(e[0]=d=>{u.onInputFile(d)})}),e[6]||(e[6]=s("div",{class:"py-2"},null,-1)),e[7]||(e[7]=s("p",null,"Task",-1)),s("select",G,e[3]||(e[3]=[s("option",null,"general segmentation - light",-1),s("option",null,"human segmentation",-1),s("option",null,"clothes segmentation",-1)]),512),p(i),o.loading?(c(),f("p",U,"Processing.. "+V(o.countdown)+"s",1)):y("",!0),p(v,{ref:"output"},null,512),e[8]||(e[8]=s("div",{class:"py-3"},null,-1)),e[9]||(e[9]=s("h4",null,"Test Samples",-1)),p(b,{onOnItem:e[1]||(e[1]=d=>u.useSample(d))})])}const q=k(C,[["render",M],["__scopeId","data-v-6ecb337d"]]);export{q as default};
